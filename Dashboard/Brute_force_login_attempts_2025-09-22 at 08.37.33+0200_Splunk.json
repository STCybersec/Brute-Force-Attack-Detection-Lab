{
  "dataSources": {
    "ds_aP3sgNs9": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m AS time_bucket\n| stats count AS failed_attempts by time_bucket\n| sort - failed_attempts\n| head 5\n| convert timeformat=\"%Y-%m-%d %H:%M:%S\" ctime(time_bucket)\n| table time_bucket, failed_attempts",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Line chart search"
    },
    "ds_kMSIDfqr": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed.*password|Accepted.*password)\"\n| stats\n    earliest(_time) AS first_attempt,\n    latest(_time) AS last_attempt,\n    latest(eval(if(result=\"Accepted password\", _time, null))) AS success_time,\n    count(eval(result=\"Failed password\")) AS fail_count,\n    count(eval(result=\"Accepted password\")) AS success_count\n    by src_ip, user\n| where fail_count >= 5 AND success_count > 0\n| eval time_to_compromise = if(isnotnull(success_time), success_time - first_attempt, null)\n| convert timeformat=\"%Y-%m-%d %H:%M:%S\" ctime(first_attempt) AS first_attempt_time\n| convert timeformat=\"%Y-%m-%d %H:%M:%S\" ctime(success_time) AS success_time\n| convert ctime(time_to_compromise) AS time_to_compromise_str\n| table src_ip, user, fail_count, success_count, first_attempt_time, success_time, time_to_compromise_str\n| sort - fail_count",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Table search"
    },
    "ds_pRehCw3O": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by user\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Pie chart search"
    },
    "ds_gb0XbsUg": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 10\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Column chart search"
    },
    "ds_cKYCA9ob": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Column chart search"
    },
    "ds_2s0xRzCY": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Column chart search"
    },
    "ds_5DLJcor5": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Area chart search"
    },
    "ds_BdgHuSbR": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Area chart search"
    },
    "ds_pZ4KqDpQ": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Area chart search"
    },
    "ds_5u8ASGqW": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by src_ip\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Column chart search"
    },
    "ds_dU51fW70": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort -total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Line chart search"
    },
    "ds_YZz0YatC": {
      "type": "ds.search",
      "options": {
        "query": "index=\"brute-force-logs\" sourcetype=\"csv\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by src_ip\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Column chart search"
    },
    "ds_az1GXg4l": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by src_ip\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Table search"
    },
    "ds_vXlbUJoa": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?<result>Failed password|Accepted password)\"\n| stats earliest(_time) AS first_fail latest(eval(if(result==\"Accepted password\", _time, null))) AS first_success count(eval(result==\"Failed password\")) AS fail_count by src_ip, user\n| where fail_count >= 5 AND isnotnull(first_success) AND first_success > first_fail\n| convert timeformat=\"%F %T\" ctime(first_fail) AS first_fail_time\n| convert timeformat=\"%F %T\" ctime(first_success) AS first_success_time\n| table src_ip, user, fail_count, first_fail_time, first_success_time",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Table search"
    },
    "ds_b9zWwB96": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by src_ip\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "-24h@h",
          "latest": "now"
        }
      },
      "name": "Area chart search"
    },
    "ds_DDlyWpwk": {
      "type": "ds.search",
      "options": {
        "query": "index=\"main\" sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by user\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Pie chart search"
    },
    "ds_4sbF3rjG": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort - total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Area chart search"
    },
    "ds_P6L4Gr1D": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort - total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Line chart search"
    },
    "ds_NmgZ8bSN": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| bin _time span=5m\n| stats count AS failed_attempts by _time, src_ip\n| eventstats sum(failed_attempts) AS total_failures by src_ip\n| sort - total_failures\n| head 5\n| timechart span=5m sum(failed_attempts) by src_ip",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Line chart search"
    },
    "ds_8HKCdr2W": {
      "type": "ds.search",
      "options": {
        "query": "index=main sourcetype=\"Brute-logs\"\n| rex field=message \"(?<result>Failed password|Accepted password)\"\n| stats earliest(_time) AS first_fail latest(eval(if(result==\"Accepted password\", _time, null))) AS first_success count(eval(result==\"Failed password\")) AS fail_count by src_ip, user\n| where fail_count >= 5 AND isnotnull(first_success) AND first_success > first_fail\n| convert timeformat=\"%F %T\" ctime(first_fail) AS first_fail_time\n| convert timeformat=\"%F %T\" ctime(first_success) AS first_success_time\n| table src_ip, user, fail_count, first_fail_time, first_success_time",
        "queryParameters": {
          "earliest": "-24h@h",
          "latest": "now"
        }
      },
      "name": "Table search"
    },
    "ds_7xUokDp1": {
      "type": "ds.search",
      "options": {
        "query": "index=\"main\" sourcetype=\"Brute-logs\" \n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by user\n| sort -failed_attempts",
        "queryParameters": {
          "earliest": "-24h@h",
          "latest": "now"
        }
      },
      "name": "Pie chart search"
    },
    "ds_6Y34yY3x": {
      "type": "ds.search",
      "options": {
        "query": "index=\"main\" sourcetype=\"Brute-logs\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts by src_ip\n| sort failed_attempts",
        "queryParameters": {
          "earliest": "-24h@h",
          "latest": "now"
        }
      },
      "name": "Column chart search"
    },
    "ds_idtjIvkI": {
      "type": "ds.search",
      "options": {
        "query": "index=\"main\"\n| rex field=message \"(?i)(?<result>Failed password|Accepted password)\"\n| where result=\"Failed password\"\n| stats count AS failed_attempts, by src_ip\n| sort failed_attempts\n| head 5",
        "queryParameters": {
          "earliest": "0"
        }
      },
      "name": "Line chart search"
    }
  },
  "visualizations": {
    "viz_4UCyThGO": {
      "type": "splunk.line",
      "options": {
        "yAxisAbbreviation": "auto",
        "y2AxisAbbreviation": "auto",
        "showRoundedY2AxisLabels": false,
        "legendTruncation": "ellipsisMiddle",
        "showY2MajorGridLines": true,
        "xAxisLabelRotation": 0,
        "xAxisTitleText": "Source IP",
        "xAxisTitleVisibility": "show",
        "yAxisTitleText": "Failed Attempts",
        "yAxisTitleVisibility": "show",
        "y2AxisTitleVisibility": "show",
        "yAxisScale": "linear",
        "showOverlayY2Axis": false,
        "y2AxisScale": "inherit",
        "nullValueDisplay": "gaps",
        "dataValuesDisplay": "all",
        "showSplitSeries": false,
        "showIndependentYRanges": false,
        "legendMode": "standard",
        "legendDisplay": "right",
        "lineWidth": 2,
        "seriesColors": [
          "#009CEB",
          "#7B56DB",
          "#00CDAF",
          "#DD9900",
          "#FF677B",
          "#CB2196",
          "#813193",
          "#0051B5",
          "#008C80",
          "#99B100",
          "#FFA476",
          "#FF6ACE",
          "#AE8CFF",
          "#00689D",
          "#00490A",
          "#465D00",
          "#9D6300",
          "#F6540B",
          "#FF969E",
          "#E47BFE"
        ]
      },
      "dataSources": {
        "primary": "ds_aP3sgNs9"
      },
      "title": "Top 5 Time Periods of Most Failed Attempts"
    },
    "viz_HnhqMM6T": {
      "type": "splunk.table",
      "options": {
        "count": 10,
        "dataOverlayMode": "none",
        "drilldown": "none",
        "showRowNumbers": false,
        "showInternalFields": false
      },
      "dataSources": {
        "primary": "ds_kMSIDfqr"
      }
    },
    "viz_KVl2B8Ga": {
      "type": "splunk.column",
      "options": {
        "yAxisAbbreviation": "auto",
        "y2AxisAbbreviation": "auto",
        "showRoundedY2AxisLabels": false,
        "legendTruncation": "ellipsisMiddle",
        "showY2MajorGridLines": true,
        "xAxisLabelRotation": -45,
        "xAxisTitleText": "Source IP",
        "xAxisTitleVisibility": "show",
        "yAxisTitleText": "Failed Attempts",
        "yAxisTitleVisibility": "show",
        "y2AxisTitleVisibility": "show",
        "yAxisScale": "linear",
        "showOverlayY2Axis": false,
        "y2AxisScale": "inherit",
        "dataValuesDisplay": "all",
        "stackMode": "auto",
        "showSplitSeries": false,
        "showIndependentYRanges": false,
        "legendDisplay": "right",
        "seriesColors": [
          "#009CEB",
          "#7B56DB",
          "#00CDAF",
          "#DD9900",
          "#FF677B",
          "#CB2196",
          "#813193",
          "#0051B5",
          "#008C80",
          "#99B100",
          "#FFA476",
          "#FF6ACE",
          "#AE8CFF",
          "#00689D",
          "#00490A",
          "#465D00",
          "#9D6300",
          "#F6540B",
          "#FF969E",
          "#E47BFE"
        ]
      },
      "dataSources": {
        "primary": "ds_5u8ASGqW"
      },
      "title": "Number of Failed Password Attempts Per IP"
    },
    "viz_49lMO22p": {
      "type": "splunk.pie",
      "options": {
        "collapseThreshold": 0.01
      },
      "dataSources": {
        "primary": "ds_DDlyWpwk"
      },
      "title": "Most Targeted Users"
    }
  },
  "inputs": {
    "input_global_trp": {
      "type": "input.timerange",
      "options": {
        "token": "global_time",
        "defaultValue": "-24h@h,now"
      },
      "title": "Global Time Range"
    }
  },
  "layout": {
    "options": {},
    "globalInputs": [
      "input_global_trp"
    ],
    "tabs": {
      "items": [
        {
          "layoutId": "layout_1",
          "label": "New tab"
        }
      ]
    },
    "layoutDefinitions": {
      "layout_1": {
        "type": "absolute",
        "structure": [
          {
            "item": "viz_49lMO22p",
            "type": "block",
            "position": {
              "x": 770,
              "y": 440,
              "w": 660,
              "h": 310
            }
          },
          {
            "item": "viz_KVl2B8Ga",
            "type": "block",
            "position": {
              "x": 770,
              "y": 10,
              "w": 660,
              "h": 420
            }
          },
          {
            "item": "viz_HnhqMM6T",
            "type": "block",
            "position": {
              "x": 90,
              "y": 760,
              "w": 1260,
              "h": 470
            }
          },
          {
            "item": "viz_4UCyThGO",
            "type": "block",
            "position": {
              "x": 10,
              "y": 10,
              "w": 740,
              "h": 740
            }
          }
        ],
        "options": {
          "width": 1440,
          "height": 2575,
          "display": "auto"
        }
      }
    }
  },
  "title": "Brute_force_login_attempts",
  "description": "A visual representation of login attempts captured on the SIEM",
  "defaults": {
    "dataSources": {
      "ds.search": {
        "options": {
          "queryParameters": {
            "latest": "$global_time.latest$",
            "earliest": "$global_time.earliest$"
          }
        }
      }
    }
  }
}